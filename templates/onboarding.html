<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding | TensorMarketData</title>
    <meta name="description" content="Complete onboarding to set up review monitoring for your business.">
    <link rel="canonical" href="https://tensormarketdata.com/onboarding">
    <style>
        :root { --accent-primary: #0D9488; --accent-hover: #0F766E; --text-primary: #0F172A; --text-secondary: #475569; --text-muted: #64748B; --bg-primary: #FFFFFF; --bg-secondary: #F8FAFC; --border-primary: #E2E8F0; --success: #059669; --error: #DC2626; --radius-lg: 12px; --radius-md: 8px; --space-4: 16px; --space-6: 24px; --space-8: 32px; --space-12: 48px; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', system-ui, sans-serif; color: var(--text-primary); line-height: 1.6; }
        .container { max-width: 700px; margin: 0 auto; padding: 0 var(--space-6); }
        nav { display: flex; justify-content: space-between; align-items: center; padding: var(--space-4) 0; border-bottom: 1px solid var(--border-primary); }
        .nav-logo { font-size: 1.25rem; font-weight: 700; color: var(--text-primary); text-decoration: none; }
        .hero { text-align: center; padding: var(--space-12) 0 var(--space-8); }
        .hero h1 { font-size: 2rem; font-weight: 700; margin-bottom: var(--space-2); }
        .hero p { color: var(--text-secondary); }
        .form-card { background: var(--bg-secondary); padding: var(--space-8); border-radius: var(--radius-lg); margin-bottom: var(--space-8); }
        .form-group { margin-bottom: var(--space-6); }
        .form-group label { display: block; font-weight: 500; margin-bottom: 8px; }
        .form-group label span { color: var(--error); }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 1px solid var(--border-primary); border-radius: var(--radius-md); font-size: 1rem; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--accent-primary); }
        .form-group .hint { font-size: 0.85rem; color: var(--text-muted); margin-top: 6px; }
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; }
        .checkbox-item { display: flex; align-items: center; gap: 10px; }
        .checkbox-item input { width: auto; }
        .checkbox-item label { margin: 0; font-weight: 400; }
        .btn { display: inline-block; padding: 14px 28px; background: var(--accent-primary); color: white; border-radius: var(--radius-md); text-decoration: none; font-weight: 500; border: none; cursor: pointer; transition: background 0.2s; width: 100%; }
        .btn:hover { background: var(--accent-hover); }
        .btn:disabled { background: var(--text-muted); cursor: not-allowed; }
        .btn-secondary { background: transparent; border: 1px solid var(--border-primary); color: var(--text-secondary); }
        .btn-secondary:hover { background: var(--bg-secondary); }
        .error { color: var(--error); font-size: 0.9rem; margin-top: 8px; display: none; }
        .form-group.error input { border-color: var(--error); }
        .form-group.error .error { display: block; }
        footer { border-top: 1px solid var(--border-primary); padding: var(--space-8) 0; margin-top: var(--space-12); text-align: center; }
        .footer-links { display: flex; gap: var(--space-6); justify-content: center; list-style: none; }
        .footer-links a { color: var(--text-muted); text-decoration: none; font-size: 0.875rem; }
        .step-indicator { display: flex; justify-content: center; gap: 8px; margin-bottom: var(--space-6); }
        .step-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--border-primary); }
        .step-dot.active { background: var(--accent-primary); }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <a href="/" class="nav-logo">TensorMarketData</a>
        </nav>
    </div>

    <div class="container">
        <section class="hero">
            <div class="step-indicator">
                <div class="step-dot active"></div>
                <div class="step-dot active"></div>
                <div class="step-dot"></div>
            </div>
            <h1>Set up your account</h1>
            <p>Tell us about your business to configure review monitoring.</p>
        </section>

        <div class="form-card">
            <form id="onboarding-form">
                <!-- Business Info -->
                <div class="form-group">
                    <label for="business_name">Business Name <span>*</span></label>
                    <input type="text" id="business_name" name="business_name" required placeholder="Your business name">
                </div>

                <div class="form-group">
                    <label for="website_url">Website URL</label>
                    <input type="url" id="website_url" name="website_url" placeholder="https://yourbusiness.com">
                </div>

                <div class="form-group">
                    <label for="contact_email">Primary Contact Email <span>*</span></label>
                    <input type="email" id="contact_email" name="contact_email" required placeholder="you@yourbusiness.com">
                    <p class="hint">We'll send invoices and reports here.</p>
                </div>

                <div class="form-group">
                    <label for="escalation_email">Escalation Contact Email <span>*</span></label>
                    <input type="email" id="escalation_email" name="escalation_email" required placeholder="you@yourbusiness.com">
                    <p class="hint">Who approves negative review responses. Can be same as contact.</p>
                </div>

                <div class="form-group">
                    <label for="business_type">Business Type <span>*</span></label>
                    <select id="business_type" name="business_type" required>
                        <option value="">Select type...</option>
                        <option value="local">Local Business</option>
                        <option value="ecommerce">Ecommerce</option>
                        <option value="saas">SaaS</option>
                        <option value="service">Service Business</option>
                    </select>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-primary); margin: 32px 0;">

                <!-- Platform Connections -->
                <div class="form-group">
                    <label>Review Platforms <span>*</span></label>
                    <p class="hint" style="margin-bottom: 12px;">Select platforms to monitor. Google Business Profile required for local businesses.</p>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="platform_google" name="platforms" value="google" checked>
                            <label for="platform_google">Google Business Profile <span style="color: var(--accent-primary);">(required)</span></label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="platform_yelp" name="platforms" value="yelp">
                            <label for="platform_yelp">Yelp</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="platform_facebook" name="platforms" value="facebook">
                            <label for="platform_facebook">Facebook</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="platform_trustpilot" name="platforms" value="trustpilot">
                            <label for="platform_trustpilot">Trustpilot</label>
                        </div>
                    </div>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-primary); margin: 32px 0;">

                <!-- Brand Voice -->
                <div class="form-group">
                    <label for="tone">Response Tone</label>
                    <select id="tone" name="tone">
                        <option value="professional">Professional</option>
                        <option value="warm">Warm</option>
                        <option value="concise">Concise</option>
                        <option value="custom">Custom (we'll ask)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="signoff">Sign-off Name</label>
                    <input type="text" id="signoff" name="signoff" placeholder="Ops Team" value="Ops Team">
                    <p class="hint">Name that appears at the end of responses.</p>
                </div>

                <div class="form-group">
                    <label>Auto-post Positive Reviews?</label>
                    <p class="hint" style="margin-bottom: 12px;">If enabled, 4-5 star reviews will be posted automatically without approval.</p>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="radio" id="autopost_no" name="autopost" value="false" checked>
                            <label for="autopost_no">No, require approval for all reviews</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="radio" id="autopost_yes" name="autopost" value="true">
                            <label for="autopost_yes">Yes, auto-post 4-5 star reviews</label>
                        </div>
                    </div>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-primary); margin: 32px 0;">

                <!-- Package B/C: Review Requests -->
                <div class="form-group" id="review-requests-section" style="display: none;">
                    <label>Review Request Source</label>
                    <p class="hint" style="margin-bottom: 12px;">How do you track completed customers? (Package B/C only)</p>
                    <select id="request_source" name="request_source">
                        <option value="">Select...</option>
                        <option value="shopify">Shopify</option>
                        <option value="csv">Manual CSV upload</option>
                        <option value="api">API integration</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Send Review Requests Via</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="channel_email" name="channels" value="email" checked>
                            <label for="channel_email">Email</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="channel_sms" name="channels" value="sms">
                            <label for="channel_sms">SMS (requires compliance confirmation)</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn">Submit & Continue</button>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <ul class="footer-links">
                <li><a href="/privacy">Privacy</a></li>
                <li><a href="/terms">Terms</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
        </div>
    </footer>

    <script>
        const form = document.getElementById('onboarding-form');
        
        // Show/hide review requests section based on package
        const urlParams = new URLSearchParams(window.location.search);
        const package = urlParams.get('package') || 'package_a';
        
        if (package === 'package_b' || package === 'package_c') {
            document.getElementById('review-requests-section').style.display = 'block';
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            // Gather form data
            const formData = new FormData(form);
            const data = {
                business_name: formData.get('business_name'),
                website_url: formData.get('website_url'),
                contact_email: formData.get('contact_email'),
                escalation_email: formData.get('escalation_email'),
                business_type: formData.get('business_type'),
                platforms: formData.getAll('platforms'),
                tone: formData.get('tone'),
                signoff: formData.get('signoff'),
                autopost: formData.get('autopost') === 'true',
                request_source: formData.get('request_source'),
                channels: formData.getAll('channels'),
                package: package,
            };

            // Validation
            if (!data.business_name || !data.contact_email || !data.escalation_email || !data.business_type) {
                alert('Please fill in all required fields.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Continue';
                return;
            }

            if (data.platforms.length === 0) {
                alert('Please select at least one platform.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Continue';
                return;
            }

            try {
                const response = await fetch('/api/onboarding', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();

                if (result.success) {
                    // Redirect to access checklist
                    window.location.href = '/access?onboarding=complete&client=' + (result.client_id || '');
                } else {
                    alert('Error: ' + (result.error || 'Something went wrong'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit & Continue';
                }
            } catch (err) {
                alert('Error submitting form. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Continue';
            }
        });
    </script>
</body>
</html>
